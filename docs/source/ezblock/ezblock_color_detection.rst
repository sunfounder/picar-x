カラー検出
===========================

PiCar-Xは、内蔵カメラを備えた自動運転車であり、Ezblockプログラムが物体検出および色認識コードを利用できるようになっています。このセクションでは、Ezblockを使用してカラー検出のプログラムを作成します。

.. note:: 

    このセクションを試みる前に、Raspberry PiカメラのFFCケーブルが正しく、しっかりと接続されていることを確認してください。FCCケーブルを確実に接続する方法の詳細な指示については、こちらを参照してください: :ref:`assembly_instructions`。

このプログラムでは、最初にEzblockに検出される色の色相-彩度-明度（HSV）範囲を指定し、次にOpenCVを使用してHSV範囲内の色を処理して背景ノイズを除去し、最後に一致する色をボックス化します。

EzblockにはPiCar-X用の6つのカラーモデルが含まれており、それらは「赤」「オレンジ」「黄」「緑」「青」「紫」となっています。次のPDFにはカラーカードが用意されており、カラープリンタで印刷する必要があります。

* :download:`[PDF]カラーカード <https://github.com/sunfounder/sf-pdf/raw/master/prop_card/object_detection/color-cards.pdf>`

.. image:: img/color_card.png
    :width: 600

.. note::

    印刷された色は、プリンターのトナーの違いや、たとえば褐色の紙といった印刷媒体のため、Ezblockのカラーモデルとは若干異なる色合いになる場合があります。これにより、色の認識精度が低下する可能性があります。

.. image:: img/ezblock_color_detect.PNG

**TIPS**

.. image:: img/sp210512_121105.png

リモートコントロールページからビデオウィジェットをドラッグすると、
ビデオモニタが生成されます。ビデオウィジェットの使用方法の詳細については、
こちらのEzblockビデオのチュートリアルを参照してください: :ref:`ezblock:video_latest`。

.. image:: img/sp210512_121125.png

**カメラモニタ** ブロックを **オン** に設定してビデオモニタを有効にします。
注: **カメラモニタ** を **オフ** に設定すると、モニタは閉じますが、物体検出は利用可能です。

.. image:: img/sp210512_134133.png

**カラー検出** ブロックを使用してカラー検出を有効にします。
注: 一度に1色のみを検出することができます。

**例**

.. note::

    * 以下の画像に従ってプログラムを書くことができます。チュートリアルを参照してください: :ref:`ezblock:create_project_latest`。
    * EzBlock Studioの **Examples** ページで同じ名前のコードを見つけ、 **Run** または **Edit** を直接クリックしてください。

.. image:: img/sp210512_134636.png
