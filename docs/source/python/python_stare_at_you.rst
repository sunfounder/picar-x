.. note::

    ã“ã‚“ã«ã¡ã¯ã€SunFounderã®Raspberry Pi & Arduino & ESP32æ„›å¥½å®¶ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã¸ã‚ˆã†ã“ãï¼Facebookä¸Šã§Raspberry Piã€Arduinoã€ESP32ã«ã¤ã„ã¦ã‚‚ã£ã¨æ·±ãæ˜ã‚Šä¸‹ã’ã€ä»–ã®æ„›å¥½å®¶ã¨äº¤æµã—ã¾ã—ã‚‡ã†ã€‚

    **å‚åŠ ã™ã‚‹ç†ç”±ã¯ï¼Ÿ**

    - **ã‚¨ã‚­ã‚¹ãƒ‘ãƒ¼ãƒˆã‚µãƒãƒ¼ãƒˆ**ï¼šã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã‚„ãƒãƒ¼ãƒ ã®åŠ©ã‘ã‚’å€Ÿã‚Šã¦ã€è²©å£²å¾Œã®å•é¡Œã‚„æŠ€è¡“çš„ãªèª²é¡Œã‚’è§£æ±ºã—ã¾ã™ã€‚
    - **å­¦ã³ï¼†å…±æœ‰**ï¼šãƒ’ãƒ³ãƒˆã‚„ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã‚’äº¤æ›ã—ã¦ã‚¹ã‚­ãƒ«ã‚’å‘ä¸Šã•ã›ã¾ã—ã‚‡ã†ã€‚
    - **ç‹¬å çš„ãªãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼**ï¼šæ–°è£½å“ã®ç™ºè¡¨ã‚„å…ˆè¡Œãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã«æ—©æœŸã‚¢ã‚¯ã‚»ã‚¹ã—ã¾ã—ã‚‡ã†ã€‚
    - **ç‰¹åˆ¥å‰²å¼•**ï¼šæœ€æ–°è£½å“ã®ç‹¬å å‰²å¼•ã‚’ãŠæ¥½ã—ã¿ãã ã•ã„ã€‚
    - **ç¥­ã‚Šã®ãƒ—ãƒ­ãƒ¢ãƒ¼ã‚·ãƒ§ãƒ³ã¨ã‚®ãƒ•ãƒˆ**ï¼šã‚®ãƒ•ãƒˆã‚„ç¥æ—¥ã®ãƒ—ãƒ­ãƒ¢ãƒ¼ã‚·ãƒ§ãƒ³ã«å‚åŠ ã—ã¾ã—ã‚‡ã†ã€‚

    ğŸ‘‰ ç§ãŸã¡ã¨ä¸€ç·’ã«æ¢ç´¢ã—ã€å‰µé€ ã™ã‚‹æº–å‚™ã¯ã§ãã¦ã„ã¾ã™ã‹ï¼Ÿ[|link_sf_facebook|]ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ä»Šã™ãå‚åŠ ã—ã¾ã—ã‚‡ã†ï¼

.. _py_stare:

8. ã‚ãªãŸã‚’è¦‹ã¤ã‚ã‚‹
==========================================

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ã€ :ref:`py_computer_vision` ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«åŸºã¥ã„ã¦ãŠã‚Šã€
é¡”æ¤œå‡ºã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ãŒè¿½åŠ ã•ã‚Œã¦ã„ã¾ã™ã€‚

ã‚«ãƒ¡ãƒ©ã®å‰ã«ç¾ã‚Œã‚‹ã¨ã€é¡”ã‚’èªè­˜ã—ã€ã‚¸ãƒ³ãƒãƒ«ã‚’èª¿æ•´ã—ã¦é¡”ã‚’ãƒ•ãƒ¬ãƒ¼ãƒ ã®ä¸­å¿ƒã«ä¿ã¡ã¾ã™ã€‚

``http://<your IP>:9000/mjpg`` ã§ç”»é¢ã‚’è¡¨ç¤ºã§ãã¾ã™ã€‚

**ã‚³ãƒ¼ãƒ‰ã®å®Ÿè¡Œ**

.. raw:: html

    <run></run>

.. code-block::

    cd ~/picar-x/example
    sudo python3 8.stare_at_you.py

ã‚³ãƒ¼ãƒ‰ãŒå®Ÿè¡Œã•ã‚Œã‚‹ã¨ã€è»Šã®ã‚«ãƒ¡ãƒ©ã¯å¸¸ã«ã‚ãªãŸã®é¡”ã‚’è¦‹ã¤ã‚ç¶šã‘ã¾ã™ã€‚

**ã‚³ãƒ¼ãƒ‰**

.. code-block:: python

    from picarx import Picarx
    from time import sleep
    from vilib import Vilib

    px = Picarx()

    def clamp_number(num,a,b):
        return max(min(num, max(a, b)), min(a, b))

    def main():
        Vilib.camera_start()
        Vilib.display()
        Vilib.face_detect_switch(True)
        x_angle =0
        y_angle =0
        while True:
            if Vilib.detect_obj_parameter['human_n']!=0:
                coordinate_x = Vilib.detect_obj_parameter['human_x']
                coordinate_y = Vilib.detect_obj_parameter['human_y']
                
                # change the pan-tilt angle for track the object
                x_angle +=(coordinate_x*10/640)-5
                x_angle = clamp_number(x_angle,-35,35)
                px.set_cam_pan_angle(x_angle)

                y_angle -=(coordinate_y*10/480)-5
                y_angle = clamp_number(y_angle,-35,35)
                px.set_cam_tilt_angle(y_angle)

                sleep(0.05)

            else :
                pass
                sleep(0.05)

    if __name__ == "__main__":
        try:
        main()
        
        finally:
            px.stop()
            print("stop and exit")
            sleep(0.1)

**ã©ã®ã‚ˆã†ã«å‹•ä½œã™ã‚‹ã®ã‹ï¼Ÿ**

``while True`` ã®ä¸­ã®ã“ã‚Œã‚‰ã®ã‚³ãƒ¼ãƒ‰è¡Œã«ã‚ˆã‚Šã€ã‚«ãƒ¡ãƒ©ãŒé¡”ã‚’è¿½ã„ã‹ã‘ã¾ã™ã€‚


.. code-block:: python

    while True:
        if Vilib.detect_obj_parameter['human_n']!=0:
            coordinate_x = Vilib.detect_obj_parameter['human_x']
            coordinate_y = Vilib.detect_obj_parameter['human_y']
            
            # change the pan-tilt angle for track the object
            x_angle +=(coordinate_x*10/640)-5
            x_angle = clamp_number(x_angle,-35,35)
            px.set_cam_pan_angle(x_angle)

            y_angle -=(coordinate_y*10/480)-5
            y_angle = clamp_number(y_angle,-35,35)
            px.set_cam_tilt_angle(y_angle)

1. æ¤œå‡ºã•ã‚ŒãŸäººé–“ã®é¡”ãŒã‚ã‚‹ã‹ã©ã†ã‹ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¾ã™

    .. code-block:: python

        Vilib.detect_obj_parameter['human_n'] != 0

2. äººé–“ã®é¡”ãŒæ¤œå‡ºã•ã‚ŒãŸå ´åˆã€æ¤œå‡ºã•ã‚ŒãŸé¡”ã®åº§æ¨™ï¼ˆ ``coordinate_x`` ã¨ ``coordinate_y`` ï¼‰ã‚’å–å¾—ã—ã¾ã™ã€‚

3. æ¤œå‡ºã•ã‚ŒãŸé¡”ã®ä½ç½®ã«åŸºã¥ã„ã¦æ–°ã—ã„ãƒ‘ãƒ³ã¨ãƒãƒ«ãƒˆè§’åº¦ï¼ˆ ``x_angle`` ã¨ ``y_angle`` ï¼‰ã‚’è¨ˆç®—ã—ã€ãã‚Œã‚‰ã‚’èª¿æ•´ã—ã¦é¡”ã‚’è¿½ã„ã‹ã‘ã¾ã™ã€‚

4. ``clamp_number`` é–¢æ•°ã‚’ä½¿ç”¨ã—ã¦ãƒ‘ãƒ³ã¨ãƒãƒ«ãƒˆè§’åº¦ã‚’æŒ‡å®šã•ã‚ŒãŸç¯„å›²å†…ã«åˆ¶é™ã—ã¾ã™ã€‚

5. ``px.set_cam_pan_angle()`` ã¨ ``px.set_cam_tilt_angle()`` ã‚’ä½¿ç”¨ã—ã¦ã‚«ãƒ¡ãƒ©ã®ãƒ‘ãƒ³ã¨ãƒãƒ«ãƒˆè§’åº¦ã‚’è¨­å®šã—ã¾ã™ã€‚
